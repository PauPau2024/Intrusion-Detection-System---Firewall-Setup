IDS and Firewall SetupThis repository contains detailed documentation and step-by-step instructions for setting up a robust network security lab environment. The core of this lab is a combination of pfSense acting as a perimeter firewall and Snort functioning as an Intrusion Detection System (IDS). The goal of this project is to provide a secure, self-contained network where you can get hands-on experience with network traffic control, real-time monitoring, and rule-based security policies without affecting your main network. This environment is perfect for learning and testing security concepts.Project OverviewThis project focuses on the practical configuration and deployment of two essential network security tools within a virtualized environment.pfSense Firewall: This is a powerful, open-source firewall distribution based on FreeBSD. When deployed in a virtual environment, it serves as the first and most critical line of defense. It acts as a gatekeeper, controlling and filtering all incoming and outgoing network traffic based on a predefined and customizable set of security rules. This allows for fine-grained control over which services and ports are accessible.Snort IDS: A widely used, open-source network intrusion detection system. Snort is configured to passively monitor all network traffic in real-time. By analyzing packets against a comprehensive set of rules, it can identify suspicious activities, malware, policy violations, and other potential threats. Upon detection, Snort generates alerts that can be logged and analyzed, providing critical visibility into what is happening on the network.Network TopologyThe network diagram below illustrates how all the components are interconnected within the virtualized lab environment. This architecture allows for a comprehensive simulation of a real-world network, complete with internal and external segments, a protected target, and a threat actor.pfSense Firewall: The central point of the network, acting as a router and firewall. It has a WAN interface that connects to the internet (via VirtualBox's NAT) and a LAN interface that connects to the private lab network.NAT Network: This is a private, isolated network segment where all the lab machines reside. The pfSense firewall manages all traffic within this network and controls its access to the outside world.Attacker Machine (Kali): A Kali Linux VM is included as a simulated threat actor. This machine is used to perform penetration tests and launch attacks to test the effectiveness of the pfSense firewall rules and Snort's detection capabilities.Linux Server (GUI): A general-purpose Linux machine that can be used for various tasks and serves as a representative client within the protected network.Splunk Server: This is a log management and analysis platform. It is configured to receive and index log data and alerts from the Snort IDS, providing a centralized location for security event monitoring and investigation.Target Machine (Windows): A Windows VM that is the primary focus of security efforts. It is the target for attacks launched from the Kali machine, allowing you to observe how the firewall and IDS protect it.Snort IDS: Deployed on one of the machines in the NAT network, Snort's role is to monitor all network traffic traversing its segment and alert on malicious activity.Setup Instructions1. Setting up the pfSense FirewallThis is the foundational step of the project. A properly configured pfSense VM is essential for all subsequent parts of the lab.Acquire pfSense Image: Download the latest stable pfSense Community Edition ISO image from the official website. Ensure you select the correct architecture (e.g., AMD64) for your system.Create Virtual Machine: Use Oracle VirtualBox to create a new virtual machine. We recommend a minimum of 1 GB RAM and 1 CPU core for smooth performance. Be sure to select the downloaded pfSense ISO as the boot image during this process.Configure Host-only Interface: Before starting the VM, you'll need a way for your host machine to communicate with the virtual network. Create a new Host-only Network in VirtualBox. This acts as a virtual switch connecting your host machine to the pfSense LAN interface.Assign Networks: In the VM settings, configure its two network adapters. Set Adapter 1 to NAT to provide Internet access (WAN), and set Adapter 2 to the Host-only Network you just created (LAN).Installation: Follow the guided installer. When prompted, make sure to correctly assign Adapter 1 as the WAN and Adapter 2 as the LAN.2. Configuring pfSenseOnce pfSense is installed, the next steps involve configuring its network settings and web interface access.Change LAN IP: By default, pfSense uses 192.168.1.1 for its LAN. You should change this to an address that aligns with your VirtualBox Host-only network (e.g., 192.168.10.1). This is a crucial step to ensure your host machine can access the pfSense web interface.Access Web Interface: After setting the LAN IP, open a web browser on your host machine and navigate to the new LAN IP address (192.168.10.1). Use the default credentials (admin/pfsense) to log in. You can now configure firewall rules from an easy-to-use graphical interface.Firewall Rules: From the Firewall > Rules menu, you can create new rules to control traffic. For example, you can add a rule on the LAN interface to block all outgoing traffic on a specific port, such as port 22 (SSH) to prevent a machine from connecting to an external server.3. Setting up Snort IDSSnort is the eyes and ears of your internal network, detecting anomalies and malicious behavior.Installation: Install Snort on your chosen Linux VM (e.g., the Linux Server). The command sudo apt-get install snort will handle the installation and any required dependencies.Rule Sets: Snort's effectiveness relies on its rule sets. Understanding them is key:Community Rules: These are a great starting point, created and maintained by the Snort user community. They are free to use.Registered Rules: Provided by Talos (Cisco's threat intelligence team). These are also free but require you to register and obtain a personal oinkcode to download them.Subscription Rules: These are the same rules as the registered set but are released to paying subscribers about a month earlier, providing a significant advantage in staying ahead of new threats.Configuration: You must edit the main snort.conf file, typically located at /etc/snort/snort.conf. The most important change is defining the HOME_NET variable to the IP address range of your protected internal network (e.g., var HOME_NET 192.168.10.0/24). This tells Snort what network to monitor.Running Snort: Once configured, you can start the Snort service. It will begin monitoring traffic and writing alerts to log files. You can use commands like tail -f /var/log/snort/alert to watch for real-time alerts.ContributingContributions are highly encouraged! If you've found an issue, identified an improvement, or want to add to this guide (e.g., a tutorial on using Splunk to analyze Snort logs), please feel free to open a pull request or an issue.LicenseThis project is open-source and available under the MIT License.
